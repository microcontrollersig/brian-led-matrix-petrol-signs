<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Brian's Petrol Signs Setup Page</title>
	<meta name="description" content="">
  	<meta name="viewport" content="width=device-width, initial-scale=1">
  	<style>
  		body {
  			background-color: #BDBDBD;

  		}

  		section {
  			max-width: 500px;
  			margin: 3rem auto;
  			background: #eceff1;
            padding: 0 0 1rem; 
  		}

        button {
    padding: 0.75rem 1.5rem;
    margin: 0.5rem 0 0;
    outline: 0;
    border: 0;
    background: #2196f3;
    border-radius: 4px;
    color: #FFF;
    font-weight: 700;
    font-size: .875rem;
    letter-spacing: .25px;
    transition: background .3s ease;        	
        }

  		.form-header {
background: #fff;
    text-align: center;
    font-size: 2rem;
    font-weight: 600;
    color: #212121;
    padding: 1rem;
    margin: 0 0 1rem;
    position: relative;  			
  		}

   .form-group {
margin: 0 2rem 1rem;   	
   }

  		.form-group label {
display: block;
    margin: 0 0 0.5rem;
    font-weight: 700;
    letter-spacing: .2px;
    font-size: 1.25rem;
    color: #212121;  			
  		}

  	.subheading {
  		text-align: center;
  	}
  	</style>
  	<script type="text/javascript">
function  post_www_url_encoded(url, data) {
    const body = new URLSearchParams();
    for (let key in data) {
        body.append(key, data[key]);
    }
    //console.log(body);
    return fetch(url, { method: "POST", body });
}

const asyncWait = ms => new Promise(resolve => setTimeout(resolve, ms))


  function recalculate(event) {
    const panelwidth = document.querySelector("input[name='panelwidth']").value;
    const panelheight = document.querySelector("input[name='panelheight']").value; 
    console.log(panelwidth, "x", panelheight);
  }

  document.addEventListener("DOMContentLoaded", function(event) {
    const ssid2 = atob('TWVsYlBDLU5VRQ==');
    const password2 = atob('cGVhY2hzcGVhazM4');

    document.querySelector("input[name='wifi2ssid']").value = ssid2;
    document.querySelector("input[name='wifi2password']").value = password2;

    document.querySelector("#savepanelsize").addEventListener("click", async function(event) {
      await post_www_url_encoded('/newpanelsize', {
        "width": document.querySelector("input[name='panelwidth']").value,
        "height": document.querySelector("input[name='panelheight']").value
      });
      await asyncWait(1500);
      alert("new panel size saved.");
    });

    document.querySelector("#savewifi").addEventListener("click", function(event) {
      const wifi1ssid = document.querySelector("input[name='wifi1ssid']").value;
      const wifi1password = document.querySelector("input[name='wifi1password']").value;
      const wifi2ssid = document.querySelector("input[name='wifi2ssid']").value;
      const wifi2password = document.querySelector("input[name='wifi2password']").value;
      document.querySelector("#wificredentials input[name='arg1']").value = wifi1ssid;
      document.querySelector("#wificredentials input[name='arg2']").value = wifi1password;
      document.querySelector("#wificredentials input[name='arg3']").value = wifi2ssid;
      document.querySelector("#wificredentials input[name='arg4']").value = wifi2password;
      document.querySelector("#wificredentials").submit();

    });

  });
  		
  	</script>
</head>
<body>

<section>
	<div class="form-header">Panel Size</div>
	<div class="form-group">
		<label>Panel Dimensions <span title="Panel at MelbPC is 6x2 (6 LED matrix across, 2 LED matrix high)" style="color:blue;">&#8505;</span></label>
		<input name="panelwidth" type="text" maxlength="2" size="2" value="6" /> x <input name="panelheight" type="text" maxlength="2" size="2" value="2" />
	</div>
	<div class="form-group">
		<button id="savepanelsize" type="button">Change</button>
	</div>
</section>
   

<section>
	<div class="form-header">Escape to Main Control Panel</div>	
	<div class="form-group">
		<p>
		  If you don't know any local wifi passwords, you can still access the Main Control Panel <a href="/main">here</a>
		</p>
	</div>
</section>
   
<section>
	<div class="form-header">Connect to a Local Wifi network</div>
	<div class="form-group subheading"><label>PRIMARY CONNECTION</label></div>
	<div class="form-group">
		<label>Network Name (SSID)</label>
	</div>
	<div class="form-group">
		<input name="wifi1ssid" />
	</div>	
	<div class="form-group">
		<label>Password</label>
	</div>
	<div class="form-group">
		<input name="wifi1password" />
	</div>		
	<div class="form-group subheading"><label>SECONDARY CONNECTION</label></div>
	<div class="form-group">
		<label>Network Name (SSID)</label>
	</div>
	<div class="form-group">
		<input name="wifi2ssid" />
	</div>	
	<div class="form-group">
		<label>Password</label>
	</div>
	<div class="form-group">
		<input name="wifi2password" />
	</div>
	<div class="form-group">
		<button id="savewifi" type="button">SAVE</button>
	</div>
</section>

<form method="post" action="/wificredentials" name="wificredentials" id="wificredentials">
  <input type="hidden" name="arg1">
  <input type="hidden" name="arg2">
  <input type="hidden" name="arg3">
  <input type="hidden" name="arg4">
</form>

</body>
</html>

